<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi Siamo - CoWorkSpace</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../assets/css/variables.css">
    <link rel="stylesheet" href="../assets/css/components.css">
    <link rel="stylesheet" href="../assets/css/layout.css">
    <link rel="stylesheet" href="../assets/css/animations.css">
    <link rel="stylesheet" href="../assets/css/responsive.css">
    <link rel="stylesheet" href="../assets/css/style.css">
</head>

<style>
    /* Stili aggiuntivi per il modal profilo */
    .profile-stats .stat-number {
        font-size: 1.5rem;
        font-weight: bold;
    }

    /* ===== BACK TO TOP BUTTON MODERNO ===== */
    .back-to-top {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 56px;
        height: 56px;
        background: var(--primary);
        color: white;
        border: none;
        border-radius: var(--radius-xl);
        font-size: 1.5rem;
        box-shadow: var(--shadow-xl);
        transition: all var(--transition-base);
        z-index: 9997;
        cursor: pointer;
    }

    .back-to-top:hover {
        background: var(--primary);
        transform: translateY(-4px);
        box-shadow: var(--shadow-2xl);
    }

    .profile-stats .stat-label {
        font-size: 0.875rem;
    }

    .form-control-plaintext {
        background-color: #f8f9fa;
        border: 1px solid #e9ecef;
        border-radius: 0.375rem;
        padding: 0.375rem 0.75rem;
        min-height: 1.5rem;
    }

    .modal-header .modal-title i {
        color: var(--bs-primary);
    }
</style>

<body>
<!-- Navigation -->
<div id="navbar-container"></div>

<!-- About Section -->
<section class="section-padding" style="margin-top: 80px;">
    <div class="container">
        <!-- Hero Section -->
        <div class="row">
            <div class="col-lg-10 mx-auto text-center">
                <h2 class="section-title">
                    <i class="fas fa-users text-primary me-3"></i>Chi Siamo
                </h2>
                <p class="section-subtitle">
                    CoWorkSpace è la piattaforma leader in Italia per la prenotazione
                    di spazi di coworking professionali e moderni.
                </p>
                <p class="lead fs-5 text-muted">
                    Fondata nel 2024, la nostra missione è rendere accessibile e flessibile
                    il lavoro moderno, offrendo una rete di spazi di alta qualità in tutte
                    le principali città italiane. Crediamo nel futuro del lavoro ibrido.
                </p>
            </div>
        </div>

        <!-- Mission & Vision Cards -->
        <div class="row mt-5">
            <div class="col-lg-6 mb-4">
                <div class="about-card h-100 shadow-sm">
                    <div class="about-icon">
                        <i class="fas fa-bullseye"></i>
                    </div>
                    <h4 class="text-primary">La Nostra Missione</h4>
                    <p class="text-muted">
                        Rendere il lavoro flessibile accessibile a tutti, creando una rete di spazi
                        professionali che favoriscano produttività, creatività e networking tra
                        professionisti e aziende di ogni dimensione.
                    </p>
                    <div class="mission-points mt-3">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            <small>Spazi professionali di qualità</small>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            <small>Flessibilità oraria e contrattuale</small>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-check-circle text-success me-2"></i>
                            <small>Community di professionisti</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 mb-4">
                <div class="about-card h-100 shadow-sm">
                    <div class="about-icon">
                        <i class="fas fa-eye"></i>
                    </div>
                    <h4 class="text-primary">La Nostra Visione</h4>
                    <p class="text-muted">
                        Diventare il punto di riferimento europeo per i workspace condivisi,
                        promuovendo un nuovo modo di lavorare che unisca flessibilità,
                        sostenibilità e innovazione tecnologica.
                    </p>
                    <div class="vision-goals mt-3">
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-globe-europe text-info me-2"></i>
                            <small>Espansione in Europa entro il 2026</small>
                        </div>
                        <div class="d-flex align-items-center mb-2">
                            <i class="fas fa-leaf text-success me-2"></i>
                            <small>100% spazi eco-sostenibili</small>
                        </div>
                        <div class="d-flex align-items-center">
                            <i class="fas fa-robot text-warning me-2"></i>
                            <small>Tecnologie AI per l'ottimizzazione</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Statistics Section -->
        <div class="stats-section mt-5">
            <div class="row">
                <div class="col-12 text-center mb-4">
                    <h3 class="section-title">I Nostri Numeri</h3>
                    <p class="text-muted">Cresciamo ogni giorno grazie alla fiducia dei nostri utenti</p>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="stats-card h-100 text-center">
                        <div class="stats-icon bg-primary-gradient mx-auto mb-3">
                            <i class="fas fa-building text-white"></i>
                        </div>
                        <h3 class="stats-number text-primary" data-target="500">0</h3>
                        <p class="stats-label text-muted mb-2">Spazi Disponibili</p>
                        <small class="text-success">
                            <i class="fas fa-arrow-up me-1"></i>+15% questo mese
                        </small>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="stats-card h-100 text-center">
                        <div class="stats-icon bg-success-gradient mx-auto mb-3">
                            <i class="fas fa-map-marker-alt text-white"></i>
                        </div>
                        <h3 class="stats-number text-success" data-target="50">0</h3>
                        <p class="stats-label text-muted mb-2">Città Coperte</p>
                        <small class="text-info">
                            <i class="fas fa-plus me-1"></i>5 nuove città
                        </small>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="stats-card h-100 text-center">
                        <div class="stats-icon bg-warning-gradient mx-auto mb-3">
                            <i class="fas fa-users text-white"></i>
                        </div>
                        <h3 class="stats-number text-warning" data-target="10000">0</h3>
                        <p class="stats-label text-muted mb-2">Utenti Attivi</p>
                        <small class="text-success">
                            <i class="fas fa-heart me-1"></i>98% soddisfatti
                        </small>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="stats-card h-100 text-center">
                        <div class="stats-icon bg-info-gradient mx-auto mb-3">
                            <i class="fas fa-calendar-check text-white"></i>
                        </div>
                        <h3 class="stats-number text-info" data-target="50000">0</h3>
                        <p class="stats-label text-muted mb-2">Prenotazioni</p>
                        <small class="text-primary">
                            <i class="fas fa-clock me-1"></i>24/7 disponibili
                        </small>
                    </div>
                </div>
            </div>
        </div>

        <!-- Team Section -->
        <div class="team-section mt-5">
            <div class="row">
                <div class="col-12 text-center mb-5">
                    <h3 class="section-title">
                        <i class="fas fa-user-friends text-primary me-2"></i>Il Nostro Team
                    </h3>
                    <p class="section-subtitle">Le persone che rendono possibile CoWorkSpace</p>
                </div>
            </div>
            <div class="row justify-content-center">
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="team-card h-100 text-center">
                        <div class="team-avatar mb-3">
                            <img src="img/Ari.jpeg"
                                 alt="Ariele Babini" class="img-fluid rounded-circle shadow-sm">
                            <div class="team-badge">
                                <i class="fas fa-crown text-warning"></i>
                            </div>
                        </div>
                        <h5 class="text-dark">Ariele Babini</h5>
                        <p class="team-role text-primary fw-bold">Admin</p>
                        <p class="team-bio text-muted small">
                            Esperto in tecnologia sviluppatore di coworkspace
                            Visionario ed appassionato di innovazione
                        </p>
                        <div class="team-stats mb-3">
                            <div class="row text-center">
                                <div class="col-4">
                                    <small class="text-muted d-block">Esperienza</small>
                                    <strong class="text-primary">5 anni</strong>
                                </div>
                                <div class="col-4">
                                    <small class="text-muted d-block">Progetti</small>
                                    <strong class="text-success">3</strong>
                                </div>
                                <div class="col-4">
                                    <small class="text-muted d-block">Linguaggi</small>
                                    <strong class="text-warning">10</strong>
                                </div>
                            </div>
                        </div>
                        <div class="team-social">
                            <a href="https://www.linkedin.com/in/ariele-babini-a849941b7/" class="social-link"><i class="fab fa-linkedin"></i></a>
                            <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                            <a href="#" class="social-link"><i class="fas fa-envelope"></i></a>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="team-card h-100 text-center">
                        <div class="team-avatar mb-3">
                            <img src="img/Bot.jpeg"
                                 alt="Federico Bottaro" class="img-fluid rounded-circle shadow-sm">
                            <div class="team-badge">
                                <i class="fas fa-code text-info"></i>
                            </div>
                        </div>
                        <h5 class="text-dark">Federico Bottaro</h5>
                        <p class="team-role text-info fw-bold">CEO</p>
                        <p class="team-bio text-muted small">
                            Lead developer con passione per l'innovazione tecnologica e l'user experience.
                            Esperto in architetture scalabili e AI.
                        </p>
                        <div class="team-stats mb-3">
                            <div class="row text-center">
                                <div class="col-4">
                                    <small class="text-muted d-block">Linguaggi</small>
                                    <strong class="text-info">15+</strong>
                                </div>
                                <div class="col-4">
                                    <small class="text-muted d-block">Progetti</small>
                                    <strong class="text-success">50+</strong>
                                </div>
                                <div class="col-4">
                                    <small class="text-muted d-block">Team</small>
                                    <strong class="text-warning">20 dev</strong>
                                </div>
                            </div>
                        </div>
                        <div class="team-social">
                            <a href="#" class="social-link"><i class="fab fa-linkedin"></i></a>
                            <a href="#" class="social-link"><i class="fab fa-github"></i></a>
                            <a href="#" class="social-link"><i class="fas fa-envelope"></i></a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Join Team Section -->
            <div class="row mt-4">
                <div class="col-12 text-center">
                    <div class="join-team-card">
                        <h5><i class="fas fa-plus-circle text-primary me-2"></i>Unisciti al Team</h5>
                        <p class="text-muted mb-3">Stiamo sempre cercando talenti appassionati</p>
                        <a href="#careers" class="btn btn-outline-primary">
                            <i class="fas fa-briefcase me-1"></i> Vedi Posizioni Aperte
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <div class="features-section mt-5">
            <div class="row">
                <div class="col-12 text-center mb-5">
                    <h3 class="section-title">
                        <i class="fas fa-star text-warning me-2"></i>Perché Scegliere CoWorkSpace
                    </h3>
                    <p class="section-subtitle">Quello che ci rende unici nel panorama italiano</p>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="feature-card h-100">
                        <div class="feature-icon">
                            <i class="fas fa-clock text-primary"></i>
                        </div>
                        <h4>Prenotazione Istantanea</h4>
                        <p class="text-muted">
                            Prenota il tuo spazio in pochi click, con conferma immediata e
                            pagamento sicuro attraverso la nostra piattaforma intuitiva e moderna.
                        </p>
                        <div class="feature-benefits">
                            <span class="badge bg-light text-primary me-1">Conferma istantanea</span>
                            <span class="badge bg-light text-primary me-1">Zero attese</span>
                            <span class="badge bg-light text-primary">24/7 disponibile</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="feature-card h-100">
                        <div class="feature-icon">
                            <i class="fas fa-shield-alt text-success"></i>
                        </div>
                        <h4>Pagamenti Sicuri</h4>
                        <p class="text-muted">
                            Tutti i pagamenti sono protetti con crittografia SSL e sistemi di
                            sicurezza avanzati per garantire la massima protezione dei tuoi dati.
                        </p>
                        <div class="feature-benefits">
                            <span class="badge bg-light text-success me-1">SSL 256-bit</span>
                            <span class="badge bg-light text-success me-1">PCI Compliant</span>
                            <span class="badge bg-light text-success">Rimborsi garantiti</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 col-md-6 mb-4">
                    <div class="feature-card h-100">
                        <div class="feature-icon">
                            <i class="fas fa-headset text-info"></i>
                        </div>
                        <h4>Supporto 24/7</h4>
                        <p class="text-muted">
                            Il nostro team di supporto è sempre disponibile per aiutarti con
                            qualsiasi necessità o domanda sui nostri servizi e spazi.
                        </p>
                        <div class="feature-benefits">
                            <span class="badge bg-light text-info me-1">Chat dal vivo</span>
                            <span class="badge bg-light text-info me-1">Telefono</span>
                            <span class="badge bg-light text-info">Email</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Values Section -->
        <div class="values-section mt-5">
            <div class="row">
                <div class="col-12 text-center mb-5">
                    <h3 class="section-title">
                        <i class="fas fa-heart text-danger me-2"></i>I Nostri Valori
                    </h3>
                    <p class="section-subtitle">I principi che guidano ogni nostra decisione</p>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="value-card h-100 text-center">
                        <i class="fas fa-handshake value-icon text-primary"></i>
                        <h5 class="mt-3">Fiducia</h5>
                        <p class="text-muted">
                            Costruiamo relazioni basate sulla trasparenza, onestà e
                            affidabilità con tutti i nostri partner e clienti.
                        </p>
                        <div class="value-metrics">
                            <small class="text-success">
                                <i class="fas fa-check-circle me-1"></i>98% feedback positivi
                            </small>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="value-card h-100 text-center">
                        <i class="fas fa-lightbulb value-icon text-warning"></i>
                        <h5 class="mt-3">Innovazione</h5>
                        <p class="text-muted">
                            Cerchiamo sempre nuove soluzioni per migliorare l'esperienza
                            e anticipare le esigenze del mercato.
                        </p>
                        <div class="value-metrics">
                            <small class="text-info">
                                <i class="fas fa-rocket me-1"></i>5 brevetti in sviluppo
                            </small>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="value-card h-100 text-center">
                        <i class="fas fa-heart value-icon text-danger"></i>
                        <h5 class="mt-3">Passione</h5>
                        <p class="text-muted">
                            Mettiamo il cuore in tutto quello che facciamo, con entusiasmo
                            e dedizione verso l'eccellenza.
                        </p>
                        <div class="value-metrics">
                            <small class="text-warning">
                                <i class="fas fa-star me-1"></i>Team satisfaction 95%
                            </small>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 col-md-6 mb-4">
                    <div class="value-card h-100 text-center">
                        <i class="fas fa-leaf value-icon text-success"></i>
                        <h5 class="mt-3">Sostenibilità</h5>
                        <p class="text-muted">
                            Promuoviamo spazi eco-friendly e pratiche sostenibili per
                            un futuro migliore per tutti.
                        </p>
                        <div class="value-metrics">
                            <small class="text-success">
                                <i class="fas fa-tree me-1"></i>Carbon neutral 2025
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Company Timeline -->
        <div class="timeline-section mt-5">
            <div class="row">
                <div class="col-12 text-center mb-5">
                    <h3 class="section-title">
                        <i class="fas fa-history text-info me-2"></i>La Nostra Storia
                    </h3>
                    <p class="section-subtitle">Il percorso che ci ha portato fin qui</p>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-8 mx-auto">
                    <div class="timeline">
                        <div class="timeline-item">
                            <div class="timeline-marker bg-primary">
                                <i class="fas fa-lightbulb text-white"></i>
                            </div>
                            <div class="timeline-content">
                                <h6 class="text-primary">Gennaio 2024</h6>
                                <h5>L'Idea</h5>
                                <p class="text-muted">Nasce l'idea di creare una piattaforma innovativa per il coworking in Italia.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-marker bg-success">
                                <i class="fas fa-rocket text-white"></i>
                            </div>
                            <div class="timeline-content">
                                <h6 class="text-success">Marzo 2024</h6>
                                <h5>Primo Lancio</h5>
                                <p class="text-muted">Lancio della piattaforma con i primi 10 spazi a Milano e Roma.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-marker bg-warning">
                                <i class="fas fa-users text-white"></i>
                            </div>
                            <div class="timeline-content">
                                <h6 class="text-warning">Giugno 2024</h6>
                                <h5>Crescita Rapida</h5>
                                <p class="text-muted">Raggiungiamo 1.000 utenti attivi e espandiamo in 5 nuove città.</p>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-marker bg-info">
                                <i class="fas fa-trophy text-white"></i>
                            </div>
                            <div class="timeline-content">
                                <h6 class="text-info">Oggi</h6>
                                <h5>Leader di Mercato</h5>
                                <p class="text-muted">Oltre 10.000 utenti attivi e 500+ spazi in 50 città italiane.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Call to Action -->
        <div class="cta-section mt-5">
            <div class="row">
                <div class="col-lg-8 mx-auto text-center">
                    <div class="cta-card">
                        <h3 class="text-white mb-3">
                            <i class="fas fa-handshake me-2"></i>Pronto a Unirti alla Community?
                        </h3>
                        <p class="text-light mb-4">
                            Scopri tutti i nostri spazi e trova quello perfetto per te.
                            La produttività ti aspetta!
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer -->
<div id="footer-container"></div>

<!-- Modals -->
<div id="modals-container">
    <div class="modal fade" id="loginModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-sign-in-alt me-2"></i>Accedi
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="loginForm">
                        <div class="mb-3">
                            <label for="loginEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="loginEmail" name="email" required>
                        </div>
                        <div class="mb-3">
                            <label for="loginPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="loginPassword" name="password" required>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="rememberMe" name="rememberMe">
                            <label class="form-check-label" for="rememberMe">Ricordami</label>
                        </div>

                        <!-- NUOVO: Link Reset Password -->
                        <div class="text-center mb-3">
                            <a href="#" id="forgotPasswordLink" class="text-decoration-none small text-muted">
                                🔑 Hai dimenticato la password?
                            </a>
                        </div>

                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-sign-in-alt me-2"></i>Accedi
                            </button>
                        </div>
                        <div class="text-center my-3">
                            <hr class="my-2">
                            <span class="text-muted bg-white px-3">oppure</span>
                        </div>

                        <div class="d-grid mb-3">
                            <a href="http://localhost:3000/api/auth/google" target="_self" class="btn btn-outline-danger google-login-btn">
                                <svg class="me-2" width="18" height="18" viewBox="0 0 24 24">
                                    <path fill="#4285f4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                                    <path fill="#34a853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                                    <path fill="#fbbc05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                                    <path fill="#ea4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                                </svg>
                                Continua con Google
                            </a>
                        </div>
                    </form>
                    <div class="text-center mt-3">
                        <p class="mb-0">Non hai un account?
                            <a href="#" onclick="switchToRegister()">Registrati qui</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="registerModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-user-plus me-2"></i>Registrati
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="registerForm">
                        <div class="mb-3">
                            <label for="registerEmail" class="form-label">Email</label>
                            <input type="email" class="form-control" id="registerEmail" name="registerEmail" required>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <label for="registerName" class="form-label">Nome</label>
                                <input type="text" class="form-control" id="registerName" name="registerName" required>
                            </div>
                            <div class="col-md-6">
                                <label for="registerSurname" class="form-label">Cognome</label>
                                <input type="text" class="form-control" id="registerSurname" name="registerSurname" required>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="registerPassword" class="form-label">Password</label>
                            <input type="password" class="form-control" id="registerPassword" name="registerPassword" required>
                            <div class="form-text">Minimo 8 caratteri con una maiuscola, una minuscola e un numero</div>
                        </div>
                        <div class="mb-3">
                            <label for="registerPasswordConfirm" class="form-label">Conferma Password</label>
                            <input type="password" class="form-control" id="registerPasswordConfirm" name="registerPasswordConfirm" required>
                        </div>
                        <div class="mb-3">
                            <label for="registerPhone" class="form-label">Telefono (opzionale)</label>
                            <input type="tel" class="form-control" id="registerPhone" name="registerPhone">
                        </div>
                        <div class="mb-3">
                            <label for="registerCompany" class="form-label">Azienda (opzionale)</label>
                            <input type="text" class="form-control" id="registerCompany" name="registerCompany">
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="acceptTerms" name="acceptTerms" required>
                            <label class="form-check-label" for="acceptTerms">
                                Accetto i <a href="#" onclick="alert('Termini e condizioni in arrivo!')">Termini e Condizioni</a>
                                e l'<a href="#" onclick="alert('Informativa Privacy in arrivo!')">Informativa Privacy</a>
                            </label>
                        </div>
                        <div class="mb-3 form-check">
                            <input type="checkbox" class="form-check-input" id="acceptMarketing" name="acceptMarketing">
                            <label class="form-check-label" for="acceptMarketing">
                                Accetto di ricevere comunicazioni marketing (facoltativo)
                            </label>
                        </div>
                        <div class="d-grid">
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-user-plus me-2"></i>Registrati
                            </button>
                        </div>
                    </form>
                    <div class="text-center mt-3">
                        <p class="mb-0">Hai già un account?
                            <a href="#" onclick="switchToLogin()">Accedi qui</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="profileModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-user-circle text-primary"></i> Il Mio Profilo
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted small">Nome</label>
                            <div class="form-control-plaintext border rounded p-2 bg-light" id="profileName">-</div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted small">Cognome</label>
                            <div class="form-control-plaintext border rounded p-2 bg-light" id="profileSurname">-</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label class="form-label text-muted small">Email</label>
                            <div class="form-control-plaintext border rounded p-2 bg-light" id="profileEmail">-</div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted small">Telefono</label>
                            <div class="form-control-plaintext border rounded p-2 bg-light" id="profilePhone">-</div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label class="form-label text-muted small">Azienda</label>
                            <div class="form-control-plaintext border rounded p-2 bg-light" id="profileCompany">-</div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times"></i> Chiudi
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="forgotPasswordModal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-key me-2"></i>Reset Password
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <!-- Form Reset Password -->
                    <div id="resetPasswordForm">
                        <p class="text-muted mb-4">
                            <i class="fas fa-info-circle me-2"></i>
                            Inserisci la tua email e ti invieremo un link per reimpostare la password.
                        </p>

                        <form id="forgotPasswordForm">
                            <div class="mb-3">
                                <label for="resetEmail" class="form-label">Email</label>
                                <input type="email" class="form-control" id="resetEmail" required
                                       placeholder="Inserisci la tua email">
                            </div>

                            <div class="d-grid mb-3">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-paper-plane me-2"></i>Invia Link Reset
                                </button>
                            </div>

                            <div class="text-center">
                                <a href="#" id="backToLogin" class="text-decoration-none">
                                    <i class="fas fa-arrow-left me-1"></i>Torna al Login
                                </a>
                            </div>
                        </form>
                    </div>

                    <!-- Messaggio di Successo -->
                    <div id="resetSuccessMessage" style="display: none;">
                        <div class="text-center">
                            <div class="mb-3">
                                <i class="fas fa-check-circle text-success" style="font-size: 3rem;"></i>
                            </div>
                            <h5 class="text-success mb-3">Email Inviata!</h5>
                            <p class="text-muted mb-4">
                                Controlla la tua casella di posta elettronica.
                                Ti abbiamo inviato un link per reimpostare la password.
                            </p>
                            <div class="alert alert-info">
                                <i class="fas fa-clock me-2"></i>
                                <strong>Importante:</strong> Il link è valido per 1 ora
                            </div>
                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                                <i class="fas fa-times me-2"></i>Chiudi
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Notification Container -->
<div id="notificationContainer" class="notification-container"></div>

<!-- Back to Top Button -->
<button id="backToTop" class="back-to-top" style="display: none;" onclick="scrollToTop()">
    <i class="fas fa-chevron-up"></i>
</button>

<!-- Scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js"></script>

<!-- App Scripts -->
<script src="../assets/js/config.js"></script>
<script src="../assets/js/utils.js"></script>
<script src="../assets/js/components.js"></script>
<script src="../assets/js/auth.js"></script>
<script src="../assets/js/notification.js"></script>
<script src="../assets/js/navigation.js"></script>
<script src="../assets/js/spaces.js"></script>
<script src="../assets/js/app.js"></script>

<script>
    // ==================== FUNZIONI GLOBALI AUTH ====================

    function showLogin() {
        console.log('🔑 showLogin function called');
        const loginModal = document.getElementById('loginModal');
        console.log('🔍 Login modal found:', !!loginModal);

        if (loginModal) {
            const modal = new bootstrap.Modal(loginModal);
            modal.show();
            console.log('✅ Login modal shown');
        } else {
            console.error('❌ Login modal not found!');
        }
    }

    function showRegister() {
        console.log('📝 showRegister function called');
        const registerModal = document.getElementById('registerModal');
        console.log('🔍 Register modal found:', !!registerModal);

        if (registerModal) {
            const modal = new bootstrap.Modal(registerModal);
            modal.show();
            console.log('✅ Register modal shown');
        } else {
            console.error('❌ Register modal not found!');
        }
    }

    function switchToRegister() {
        console.log('🔄 Switching to register modal');
        const loginModal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
        if (loginModal) loginModal.hide();

        setTimeout(() => {
            const registerModal = new bootstrap.Modal(document.getElementById('registerModal'));
            registerModal.show();
        }, 300);
    }

    function switchToLogin() {
        console.log('🔄 Switching to login modal');
        const registerModal = bootstrap.Modal.getInstance(document.getElementById('registerModal'));
        if (registerModal) registerModal.hide();

        setTimeout(() => {
            const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
            loginModal.show();
        }, 300);
    }

    function logout() {
        console.log('🚪 Eseguo il logout...');

        // Clear authentication
        if (window.coworkspaceApp) {
            window.coworkspaceApp.clearAuth();
        }

        // Clear storage
        localStorage.removeItem('auth_token');
        localStorage.removeItem('user');
        localStorage.removeItem('currentUser');
        sessionStorage.removeItem('login_success');
        localStorage.removeItem('just_logged_in');

        // Show success message
        showNotificationMessage('Logout effettuato con successo!', 'success');

        // Redirect to home
        setTimeout(() => {
            window.location.href = '../index.html';
        }, 1500);
    }

    // ==================== ABOUT PAGE SPECIFIC FUNCTIONS ====================

    function handleExploreSpaces() {
        console.log('🔍 Navigating to spaces...');

        // Try different navigation methods
        if (typeof showSection === 'function') {
            showSection('spaces');
        } else if (window.Navigation && window.Navigation.showSection) {
            window.Navigation.showSection('spaces');
        } else if (window.App && window.App.navigation && window.App.navigation.showSection) {
            window.App.navigation.showSection('spaces');
        } else {
            // Fallback: direct navigation
            if (window.location.pathname.includes('template/')) {
                window.location.href = 'spaces.html';
            } else {
                window.location.href = 'template/spaces.html';
            }
        }
    }

    function handleRegisterButton() {
        console.log('📝 Handling register button...');

        // Check if user is already logged in
        if (isUserLoggedIn()) {
            showNotificationMessage('Sei già registrato e collegato!', 'info');
            return;
        }

        // If not logged in, show registration modal
        showRegister();
    }

    // Function to check if user is logged in
    function isUserLoggedIn() {
        // 1. Check localStorage
        const tokens = ['authToken', 'jwt', 'user', 'token'];
        for (let token of tokens) {
            const value = localStorage.getItem(token);
            if (value && value !== 'null' && value !== 'undefined') {
                console.log(`✅ Found auth token in localStorage: ${token}`);
                return true;
            }
        }

        // 2. Check sessionStorage
        for (let token of tokens) {
            const value = sessionStorage.getItem(token);
            if (value && value !== 'null' && value !== 'undefined') {
                console.log(`✅ Found auth token in sessionStorage: ${token}`);
                return true;
            }
        }

        // 3. Check global auth objects
        if (window.coworkspaceApp && window.coworkspaceApp.state && window.coworkspaceApp.state.isAuthenticated) {
            console.log('✅ Found auth in window.coworkspaceApp');
            return true;
        }

        // 4. Check DOM elements
        const userMenu = document.getElementById('userMenu');
        if (userMenu && userMenu.style.display !== 'none' && !userMenu.classList.contains('d-none')) {
            console.log('✅ Found visible userMenu in DOM');
            return true;
        }

        const authButtons = document.getElementById('authButtons');
        if (authButtons && (authButtons.style.display === 'none' || authButtons.classList.contains('d-none'))) {
            console.log('✅ Found hidden authButtons in DOM');
            return true;
        }

        console.log('❌ User not authenticated');
        return false;
    }

    // Helper function to show notifications
    function showNotificationMessage(message, type = 'info') {
        if (window.coworkspaceApp && window.coworkspaceApp.showNotification) {
            window.coworkspaceApp.showNotification(message, type);
        } else if (window.App && window.App.utils && window.App.utils.showNotification) {
            window.App.utils.showNotification(message, type);
        } else {
            console.log(`Notification: ${message}`);
            alert(message);
        }
    }

    // ==================== ABOUT PAGE ANIMATIONS ====================

    // Animate statistics counters
    function initStatsAnimation() {
        const statsNumbers = document.querySelectorAll('.stats-number');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const target = parseInt(entry.target.dataset.target);
                    animateCounter(entry.target, target);
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.5 });

        statsNumbers.forEach(stat => {
            observer.observe(stat);
        });
    }

    // Counter animation function
    function animateCounter(element, target) {
        let current = 0;
        const increment = target / 100;
        const timer = setInterval(() => {
            current += increment;
            if (current >= target) {
                current = target;
                clearInterval(timer);
            }

            // Format number based on value
            let displayValue;
            if (target >= 10000) {
                displayValue = Math.floor(current / 1000) + 'K+';
            } else if (target >= 1000) {
                displayValue = Math.floor(current).toLocaleString() + '+';
            } else {
                displayValue = Math.floor(current) + '+';
            }

            element.textContent = displayValue;
        }, 20);
    }

    // Initialize team features
    function initTeamFeatures() {
        // Add team member hover effects
        const teamCards = document.querySelectorAll('.team-card');
        teamCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-10px) scale(1.02)';
                this.style.transition = 'all 0.3s ease';
            });

            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
        });

        // Add social link tracking
        const socialLinks = document.querySelectorAll('.social-link');
        socialLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const teamMember = this.closest('.team-card').querySelector('h5').textContent;
                const platform = this.querySelector('i').className;

                console.log(`Social link clicked: ${teamMember} - ${platform}`);
                showNotificationMessage(
                    `Link social di ${teamMember} - Funzionalità disponibile nella versione completa`,
                    'info'
                );
            });
        });
    }

    // Initialize timeline animation
    function initTimelineAnimation() {
        const timelineItems = document.querySelectorAll('.timeline-item');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry, index) => {
                if (entry.isIntersecting) {
                    setTimeout(() => {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateX(0)';
                    }, index * 200);
                    observer.unobserve(entry.target);
                }
            });
        }, { threshold: 0.3 });

        timelineItems.forEach(item => {
            item.style.opacity = '0';
            item.style.transform = 'translateX(-50px)';
            item.style.transition = 'all 0.6s ease';
            observer.observe(item);
        });
    }

    // Initialize scroll effects
    function initScrollEffects() {
        const cards = document.querySelectorAll('.about-card, .feature-card, .value-card, .stats-card');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }
            });
        }, { threshold: 0.1 });

        cards.forEach((card, index) => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(30px)';
            card.style.transition = `all 0.6s ease ${index * 0.1}s`;
            observer.observe(card);
        });
    }

    // Add hover effects
    function addHoverEffects() {
        // Value cards hover effect
        const valueCards = document.querySelectorAll('.value-card');
        valueCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                const icon = this.querySelector('.value-icon');
                if (icon) {
                    icon.style.transform = 'scale(1.2) rotate(10deg)';
                    icon.style.transition = 'all 0.3s ease';
                }
            });

            card.addEventListener('mouseleave', function() {
                const icon = this.querySelector('.value-icon');
                if (icon) {
                    icon.style.transform = 'scale(1) rotate(0deg)';
                }
            });
        });

        // Feature cards pulse effect
        const featureCards = document.querySelectorAll('.feature-card');
        featureCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                const icon = this.querySelector('.feature-icon i');
                if (icon) {
                    icon.style.animation = 'pulse 1s infinite';
                }
            });

            card.addEventListener('mouseleave', function() {
                const icon = this.querySelector('.feature-icon i');
                if (icon) {
                    icon.style.animation = 'none';
                }
            });
        });
    }

    // ==================== DOM CONTENT LOADED ====================

    document.addEventListener('DOMContentLoaded', async function () {
        try {
            // Load page components
            await loadComponent('navbar-container', '../components/navbar.html');
            await loadComponent('footer-container', '../components/footer.html');
            // Note: Modals are already in the page HTML, no need to load them

            // Initialize about page features
            initStatsAnimation();
            initTeamFeatures();
            initTimelineAnimation();
            initScrollEffects();
            addHoverEffects();

            // Initialize app if available
            if (!window.coworkspaceApp) {
                window.coworkspaceApp = new CoWorkSpaceApp();
            }

            await window.coworkspaceApp.initializePage();
            window.coworkspaceApp.checkAuth();

            console.log('✅ About page initialized successfully');

        } catch (error) {
            console.error('❌ Error initializing about page:', error);
        }

        // ==================== EVENT HANDLERS FORM ====================

        // Form Login Handler
        const loginForm = document.getElementById('loginForm');
        if (loginForm) {
            loginForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                console.log('🔓 Login form submitted');

                if (window.coworkspaceApp && window.coworkspaceApp.handleLogin) {
                    await window.coworkspaceApp.handleLogin(this);
                } else {
                    // Fallback for testing
                    const email = this.loginEmail.value;
                    const password = this.loginPassword.value;

                    console.log('📧 Login attempt:', { email, password: '***' });

                    const loginModal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
                    if (loginModal) loginModal.hide();

                    showNotificationMessage('Login simulato riuscito!', 'success');
                }
            });
        }

        // Form Register Handler
        const registerForm = document.getElementById('registerForm');
        if (registerForm) {
            registerForm.addEventListener('submit', async function(e) {
                e.preventDefault();
                console.log('📝 Register form submitted');

                // Validation
                const password = this.registerPassword.value;
                const confirmPassword = this.registerPasswordConfirm.value;

                if (password !== confirmPassword) {
                    showNotificationMessage('Le password non coincidono!', 'error');
                    return;
                }

                if (password.length < 8) {
                    showNotificationMessage('La password deve essere di almeno 8 caratteri!', 'error');
                    return;
                }

                if (!this.acceptTerms.checked) {
                    showNotificationMessage('Devi accettare i Termini e Condizioni!', 'error');
                    return;
                }

                if (window.coworkspaceApp && window.coworkspaceApp.handleRegister) {
                    await window.coworkspaceApp.handleRegister(this);
                } else {
                    // Fallback for testing
                    const formData = new FormData(this);
                    const userData = Object.fromEntries(formData);
                    delete userData.registerPasswordConfirm;

                    console.log('👤 Register attempt:', userData);

                    const registerModal = bootstrap.Modal.getInstance(document.getElementById('registerModal'));
                    if (registerModal) registerModal.hide();

                    showNotificationMessage('Registrazione simulata riuscita!', 'success');

                    // Show login modal after registration
                    setTimeout(() => {
                        const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
                        loginModal.show();

                        // Pre-fill email in login
                        document.getElementById('loginEmail').value = userData.registerEmail;
                    }, 1000);
                }
            });
        }

        // Add click tracking for CTA buttons
        const ctaButtons = document.querySelectorAll('.cta-buttons .btn, .btn[onclick*="handleExploreSpaces"], .btn[onclick*="handleRegisterButton"]');
        ctaButtons.forEach(button => {
            button.addEventListener('click', function() {
                const buttonText = this.textContent.trim();
                console.log(`CTA clicked: ${buttonText}`);

                // Track with analytics if available
                if (window.gtag) {
                    gtag('event', 'cta_click', {
                        'event_category': 'about_page',
                        'event_label': buttonText
                    });
                }
            });
        });

        // Track join team button
        const joinTeamBtn = document.querySelector('[href="#careers"]');
        if (joinTeamBtn) {
            joinTeamBtn.addEventListener('click', function(e) {
                e.preventDefault();
                showNotificationMessage(
                    'Sezione carriere in arrivo! Tieni d\'occhio i nostri canali social.',
                    'info'
                );
            });
        }

        // Error handling for images
        document.querySelectorAll('img').forEach(img => {
            img.addEventListener('error', function() {
                if (this.dataset.errorHandled === 'true') {
                    return;
                }
                this.dataset.errorHandled = 'true';

                this.style.display = 'none';

                // Create placeholder with icon
                const placeholder = document.createElement('div');
                placeholder.style.cssText = `
                    width: 120px;
                    height: 120px;
                    border-radius: 50%;
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    color: white;
                    font-size: 2rem;
                    margin: 0 auto;
                `;
                placeholder.innerHTML = '<i class="fas fa-user"></i>';

                this.parentNode.insertBefore(placeholder, this);
                console.log('🖼️ Image replaced with icon placeholder');
            });
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Press 'T' to scroll to team section
            if (e.key.toLowerCase() === 't' && !e.ctrlKey && !e.altKey) {
                const teamSection = document.querySelector('.team-section');
                if (teamSection) {
                    teamSection.scrollIntoView({ behavior: 'smooth' });
                }
            }

            // Press 'V' to scroll to values section
            if (e.key.toLowerCase() === 'v' && !e.ctrlKey && !e.altKey) {
                const valuesSection = document.querySelector('.values-section');
                if (valuesSection) {
                    valuesSection.scrollIntoView({ behavior: 'smooth' });
                }
            }
        });

        // Add parallax effect to hero section
        window.addEventListener('scroll', function() {
            const scrolled = window.pageYOffset;
            const heroElements = document.querySelectorAll('.hero-section .section-title, .hero-section .section-subtitle');

            heroElements.forEach(element => {
                const speed = 0.3;
                element.style.transform = `translateY(${scrolled * speed}px)`;
            });
        });

        // Initialize tooltips for team stats
        const teamStats = document.querySelectorAll('.team-stats [data-bs-toggle="tooltip"]');
        teamStats.forEach(stat => {
            new bootstrap.Tooltip(stat);
        });

        console.log('✅ About page event handlers initialized');

        // ==================== PROFILE FUNCTIONS ====================

        function showProfile() {
            console.log('🔍 Opening profile modal...');

            let currentUser = getCurrentUserData();

            if (!currentUser) {
                showNotificationMessage('Devi essere loggato per vedere il tuo profilo.', 'warning');
                setTimeout(() => showLogin(), 1000);
                return;
            }

            console.log('✅ User found:', currentUser);

            // Mostra il modal
            const profileModal = new bootstrap.Modal(document.getElementById('profileModal'));
            profileModal.show();

            // Popola con un piccolo delay
            setTimeout(() => {
                populateProfileModal(currentUser);
            }, 200);
        }

        function getCurrentUserData() {
            let currentUser = null;

            // 1. Controlla coworkspaceApp
            if (window.coworkspaceApp && window.coworkspaceApp.state && window.coworkspaceApp.state.currentUser) {
                currentUser = window.coworkspaceApp.state.currentUser;
                console.log('✅ Found user in coworkspaceApp:', currentUser);
                return currentUser;
            }

            // 2. Controlla localStorage con diverse chiavi
            const userKeys = ['user', 'currentUser', 'auth_user', 'loggedUser'];

            for (let key of userKeys) {
                try {
                    const userJson = localStorage.getItem(key);
                    if (userJson && userJson !== 'null' && userJson !== 'undefined') {
                        currentUser = JSON.parse(userJson);
                        console.log(`✅ Found user in localStorage[${key}]:`, currentUser);
                        return currentUser;
                    }
                } catch (error) {
                    console.error(`Error parsing localStorage[${key}]:`, error);
                }
            }

            // 3. Controlla sessionStorage
            for (let key of userKeys) {
                try {
                    const userJson = sessionStorage.getItem(key);
                    if (userJson && userJson !== 'null' && userJson !== 'undefined') {
                        currentUser = JSON.parse(userJson);
                        console.log(`✅ Found user in sessionStorage[${key}]:`, currentUser);
                        return currentUser;
                    }
                } catch (error) {
                    console.error(`Error parsing sessionStorage[${key}]:`, error);
                }
            }

            // 4. Se non trova nulla, crea utente demo per test
            console.log('❌ No user found, creating demo user for testing...');
            currentUser = {
                first_name: 'Ariele',
                last_name: 'Babini',
                email: 'ariele@gmail.com',
                phone: '+39 333 1234567',
                company: 'CoWorkSpace Demo'
            };

            return currentUser;
        }

        function populateProfileModal(user) {
            console.log('🔄 Populating profile modal with user:', user);

            if (!user || typeof user !== 'object') {
                showNotificationMessage('Errore: dati utente non disponibili', 'error');
                return;
            }

            // Mappatura completa dei campi - gestisce diverse varianti
            const userData = {
                firstName: user.first_name || user.firstName || user.name || user.given_name || 'Non disponibile',
                lastName: user.last_name || user.lastName || user.surname || user.family_name || 'Non disponibile',
                email: user.email || user.mail || user.email_address || 'Non disponibile',
                phone: user.phone || user.phoneNumber || user.phone_number || user.mobile || 'Non disponibile',
                company: user.company || user.company_name || user.organization || user.workplace || 'Non disponibile'
            };

            console.log('📋 Mapped user data:', userData);

            // Popola campi di visualizzazione
            const elements = {
                profileName: document.getElementById('profileName'),
                profileSurname: document.getElementById('profileSurname'),
                profileEmail: document.getElementById('profileEmail'),
                profilePhone: document.getElementById('profilePhone'),
                profileCompany: document.getElementById('profileCompany')
            };

            // Controlla se gli elementi esistono
            Object.keys(elements).forEach(key => {
                console.log(`Element ${key}:`, !!elements[key]);
            });

            // Popola i campi
            if (elements.profileName) {
                elements.profileName.textContent = userData.firstName;
                console.log('✅ Set profileName:', userData.firstName);
            }

            if (elements.profileSurname) {
                elements.profileSurname.textContent = userData.lastName;
                console.log('✅ Set profileSurname:', userData.lastName);
            }

            if (elements.profileEmail) {
                elements.profileEmail.textContent = userData.email;
                console.log('✅ Set profileEmail:', userData.email);
            }

            if (elements.profilePhone) {
                elements.profilePhone.textContent = userData.phone;
                console.log('✅ Set profilePhone:', userData.phone);
            }

            if (elements.profileCompany) {
                elements.profileCompany.textContent = userData.company;
                console.log('✅ Set profileCompany:', userData.company);
            }

            console.log('✅ Profile modal populated successfully');
        }

        // Rendi le funzioni globali per compatibilità
        window.User = {
            populateProfileModal: populateProfileModal,
            getCurrentUserData: getCurrentUserData
        };

        window.showProfile = showProfile;

        // ==================== GESTIONE MODAL RESET PASSWORD ====================

        // Click su "Hai dimenticato la password?"
        document.addEventListener('click', function(e) {
            if (e.target.id === 'forgotPasswordLink') {
                e.preventDefault();

                // Nascondi modal login
                const loginModal = bootstrap.Modal.getInstance(document.getElementById('loginModal'));
                if (loginModal) loginModal.hide();

                // Mostra modal reset password
                const forgotModal = new bootstrap.Modal(document.getElementById('forgotPasswordModal'));
                forgotModal.show();

                // Reset form
                document.getElementById('forgotPasswordForm').reset();
                document.getElementById('resetPasswordForm').style.display = 'block';
                document.getElementById('resetSuccessMessage').style.display = 'none';
            }

            // Click su "Torna al Login"
            if (e.target.id === 'backToLogin') {
                e.preventDefault();

                // Nascondi modal reset
                const forgotModal = bootstrap.Modal.getInstance(document.getElementById('forgotPasswordModal'));
                if (forgotModal) forgotModal.hide();

                // Mostra modal login
                const loginModal = new bootstrap.Modal(document.getElementById('loginModal'));
                loginModal.show();
            }
        });

        // ==================== GESTIONE FORM RESET PASSWORD ====================

        const forgotPasswordForm = document.getElementById('forgotPasswordForm');
        if (forgotPasswordForm) {
            forgotPasswordForm.addEventListener('submit', async function(e) {
                e.preventDefault();

                const email = document.getElementById('resetEmail').value.trim();
                const submitBtn = e.target.querySelector('button[type="submit"]');
                const originalBtnContent = submitBtn.innerHTML;

                // Validazione base
                if (!email) {
                    showNotificationInModal('Inserisci un indirizzo email valido', 'error');
                    return;
                }

                // Validazione formato email
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    showNotificationInModal('Formato email non valido', 'error');
                    return;
                }

                // Mostra loading
                submitBtn.disabled = true;
                submitBtn.classList.add('btn-loading');
                submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Invio in corso...';

                try {
                    console.log('Sending password reset request for:', email);

                    const response = await fetch('/api/auth/forgot-password', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Accept': 'application/json'
                        },
                        body: JSON.stringify({ email })
                    });

                    const data = await response.json();
                    console.log('Reset password response:', data);

                    if (response.ok && data.success) {
                        // Mostra messaggio di successo
                        document.getElementById('resetPasswordForm').style.display = 'none';
                        document.getElementById('resetSuccessMessage').style.display = 'block';

                        // Auto-chiudi dopo 5 secondi
                        setTimeout(() => {
                            const forgotModal = bootstrap.Modal.getInstance(document.getElementById('forgotPasswordModal'));
                            if (forgotModal) forgotModal.hide();

                            // Reset per il prossimo utilizzo
                            setTimeout(() => {
                                document.getElementById('resetPasswordForm').style.display = 'block';
                                document.getElementById('resetSuccessMessage').style.display = 'none';
                                forgotPasswordForm.reset();
                            }, 500);
                        }, 5000);

                    } else {
                        // Mostra errore
                        const errorMessage = data.message || 'Errore durante l\'invio dell\'email. Riprova.';
                        showNotificationInModal(errorMessage, 'error');
                    }

                } catch (error) {
                    console.error('Reset password error:', error);

                    // Gestisci errori di rete
                    if (error.name === 'TypeError' && error.message.includes('fetch')) {
                        showNotificationInModal('Problema di connessione. Verifica la tua rete.', 'error');
                    } else {
                        showNotificationInModal('Errore imprevisto. Riprova più tardi.', 'error');
                    }
                } finally {
                    // Ripristina bottone
                    submitBtn.disabled = false;
                    submitBtn.classList.remove('btn-loading');
                    submitBtn.innerHTML = originalBtnContent;
                }
            });
        }

        // ==================== FUNZIONI HELPER ====================

        function showNotificationInModal(message, type = 'info') {
            // Rimuovi notifiche precedenti nel modal
            const existingAlerts = document.querySelectorAll('#forgotPasswordModal .alert');
            existingAlerts.forEach(alert => alert.remove());

            // Crea nuova notifica
            const alertClass = type === 'error' ? 'alert-danger' :
                type === 'success' ? 'alert-success' :
                    type === 'warning' ? 'alert-warning' : 'alert-info';

            const icon = type === 'error' ? 'fas fa-exclamation-triangle' :
                type === 'success' ? 'fas fa-check-circle' :
                    type === 'warning' ? 'fas fa-exclamation-circle' : 'fas fa-info-circle';

            const alertDiv = document.createElement('div');
            alertDiv.className = `alert ${alertClass} alert-dismissible fade show mt-3`;
            alertDiv.innerHTML = `
            <i class="${icon} me-2"></i>${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;

            // Inserisci prima del form
            const modalBody = document.querySelector('#forgotPasswordModal .modal-body');
            const form = document.getElementById('resetPasswordForm');
            modalBody.insertBefore(alertDiv, form);

            // Auto-rimuovi dopo 5 secondi
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 5000);
        }

        // ==================== MIGLIORA L'UX ====================

        // Auto-focus sul campo email quando si apre il modal
        document.getElementById('forgotPasswordModal').addEventListener('shown.bs.modal', function() {
            document.getElementById('resetEmail').focus();
        });

        // Gestisci il tasto Invio nel campo email
        document.getElementById('resetEmail')?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                document.getElementById('forgotPasswordForm').dispatchEvent(new Event('submit'));
            }
        });

        console.log('Password reset system initialized');
    });
</script>
</body>
</html>