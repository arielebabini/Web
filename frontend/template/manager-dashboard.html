<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manager Dashboard - CoWorkSpace</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --primary: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            --primary-solid: #28a745;
            --sidebar-width: 280px;
            --header-height: 70px;
        }

        body {
            background: #f8fafc;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        /* Sidebar */
        .manager-sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: var(--sidebar-width);
            background: linear-gradient(180deg, #155724 0%, #0f3e14 100%);
            color: white;
            z-index: 1000;
            transition: all 0.3s ease;
            overflow-y: auto;
        }

        .manager-sidebar.collapsed {
            width: 80px;
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid #1e7e34;
            text-align: center;
        }

        .sidebar-brand {
            font-size: 1.5rem;
            font-weight: 800;
            color: white;
            text-decoration: none;
        }

        .sidebar-menu {
            padding: 1rem 0;
        }

        .sidebar-item {
            margin: 0.25rem 1rem;
        }

        .sidebar-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            color: #c6f7d0;
            text-decoration: none;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .sidebar-link:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateX(4px);
        }

        .sidebar-link.active {
            background: var(--primary);
            color: white;
        }

        .sidebar-icon {
            width: 20px;
            margin-right: 0.75rem;
            text-align: center;
        }

        /* Main content */
        .manager-main {
            margin-left: var(--sidebar-width);
            min-height: 100vh;
            transition: margin-left 0.3s ease;
        }

        .manager-main.expanded {
            margin-left: 80px;
        }

        .manager-header {
            background: white;
            height: var(--header-height);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            position: sticky;
            top: 0;
            z-index: 999;
        }

        .manager-content {
            padding: 2rem;
        }

        /* Cards */
        .manager-card {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 4px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .manager-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 40px rgba(0, 0, 0, 0.12);
        }

        .stats-card {
            background: var(--primary);
            color: white;
            border: none;
        }

        .stats-card .stats-icon {
            font-size: 2.5rem;
            opacity: 0.8;
        }

        /* Tables */
        .manager-table {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 4px 25px rgba(0, 0, 0, 0.08);
        }

        .manager-table table {
            margin: 0;
        }

        .manager-table th {
            background: #f8fafc;
            border: none;
            padding: 1rem 1.5rem;
            font-weight: 600;
            color: #4a5568;
        }

        .manager-table td {
            border: none;
            padding: 1rem 1.5rem;
            vertical-align: middle;
        }

        .manager-table tbody tr {
            border-bottom: 1px solid #e2e8f0;
            transition: background-color 0.2s ease;
        }

        .manager-table tbody tr:hover {
            background: #f7fafc;
        }

        /* Buttons */
        .btn-manager {
            border-radius: 8px;
            font-weight: 600;
            padding: 0.5rem 1rem;
            transition: all 0.3s ease;
        }

        .btn-manager-primary {
            background: var(--primary);
            border: none;
            color: white;
        }

        .btn-manager-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
            color: white;
        }

        /* Status badges */
        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-active {
            background: #d4edda;
            color: #155724;
        }

        .status-inactive {
            background: #f8d7da;
            color: #721c24;
        }

        .status-suspended {
            background: #fff3cd;
            color: #856404;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .manager-sidebar {
                transform: translateX(-100%);
            }

            .manager-sidebar.mobile-open {
                transform: translateX(0);
            }

            .manager-main {
                margin-left: 0;
            }
        }

        /* Loading states */
        .loading {
            opacity: 0.6;
            pointer-events: none;
        }

        .spinner-border-sm {
            width: 1rem;
            height: 1rem;
        }

        /* Charts */
        .chart-container {
            position: relative;
            height: 300px;
        }
    </style>
</head>
<body>
<div class="manager-sidebar" id="managerSidebar">
    <div class="sidebar-header">
        <a class="sidebar-brand" href="#">
            <i class="fas fa-user-tie"></i>
            <span class="brand-text">Manager</span>
        </a>
    </div>

    <div class="sidebar-menu">
        <div class="sidebar-item">
            <a class="sidebar-link active" href="#dashboard" onclick="showSection('dashboard')">
                <i class="fas fa-tachometer-alt sidebar-icon"></i>
                <span>Dashboard</span>
            </a>
        </div>
        <div class="sidebar-item">
            <a class="sidebar-link" href="#spaces" onclick="showSection('spaces')">
                <i class="fas fa-building sidebar-icon"></i>
                <span>Gestione Spazi</span>
            </a>
        </div>
        <div class="sidebar-item">
            <a class="sidebar-link" href="#bookings" onclick="showSection('bookings')">
                <i class="fas fa-calendar-check sidebar-icon"></i>
                <span>Prenotazioni</span>
            </a>
        </div>
        <div class="sidebar-item mt-4">
            <a class="sidebar-link" href="../index.html">
                <i class="fas fa-arrow-left sidebar-icon"></i>
                <span>Torna al Sito</span>
            </a>
        </div>
    </div>
</div>

<div class="manager-main" id="managerMain">
    <div class="manager-header">
        <div class="d-flex align-items-center">
            <h4 class="mb-0" id="pageTitle">Dashboard</h4>
        </div>
        <div class="d-flex align-items-center">
            <div class="dropdown">
                <button class="btn btn-outline-primary dropdown-toggle" data-bs-toggle="dropdown">
                    <i class="fas fa-user"></i>
                    <span id="managerUserName">Manager</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end">
                    <li><a class="dropdown-item" href="#profile"><i class="fas fa-user me-2"></i>Profilo</a></li>
                    <li>
                        <hr class="dropdown-divider">
                    </li>
                    <li><a class="dropdown-item" href="#" onclick="logout()"><i class="fas fa-sign-out-alt me-2"></i>Logout</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <div class="manager-content">
        <div class="manager-section" id="dashboardSection">
            <div class="position-fixed..." id="dashboard-loading" style="display: none !important;">
                <div class="text-center">
                    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;"></div>
                    <div class="mt-2">Caricamento statistiche...</div>
                </div>
            </div>

            <div id="dashboard-error" style="display: none;"></div>

            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h4><i class="fas fa-chart-line text-primary"></i> Dashboard Manager</h4>
                </div>
            </div>

            <div class="row mb-4">
                <div class="col-md-3 mb-3">
                    <div class="card bg-primary text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h6 class="card-title">Utenti Totali</h6>
                                    <h3 class="mb-0" id="total-users">0</h3>
                                    <small>+<span id="new-users">0</span> nuovi</small>
                                </div>
                                <i class="fas fa-users fa-2x opacity-75"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-3 mb-3">
                    <div class="card bg-info text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h6 class="card-title">Spazi Attivi</h6>
                                    <h3 class="mb-0" id="total-spaces">0</h3>
                                    <small>spazi disponibili</small>
                                </div>
                                <i class="fas fa-building fa-2x opacity-75"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-3 mb-3">
                    <div class="card bg-success text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h6 class="card-title">Prenotazioni</h6>
                                    <h3 class="mb-0" id="total-bookings">0</h3>
                                    <small><span id="confirmed-bookings">0</span> confermate</small>
                                </div>
                                <i class="fas fa-calendar-check fa-2x opacity-75"></i>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-3 mb-3">
                    <div class="card bg-warning text-white">
                        <div class="card-body">
                            <div class="d-flex justify-content-between">
                                <div>
                                    <h6 class="card-title">Revenue Totale</h6>
                                    <h3 class="mb-0" id="total-revenue">€0.00</h3>
                                    <small><span id="total-payments">0</span> pagamenti</small>
                                </div>
                                <i class="fas fa-euro-sign fa-2x opacity-75"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-8 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-chart-area text-success"></i> Andamento Revenue</h5>
                        </div>
                        <div class="card-body">
                            <div class="row mb-3">
                                <div class="col-md-4 text-center">
                                    <div class="border-end">
                                        <h6 class="text-muted">Periodo Corrente</h6>
                                        <h4 class="text-success" id="current-revenue">€0.00</h4>
                                    </div>
                                </div>
                                <div class="col-md-4 text-center">
                                    <div class="border-end">
                                        <h6 class="text-muted">Periodo Precedente</h6>
                                        <h4 class="text-muted" id="previous-revenue">€0.00</h4>
                                    </div>
                                </div>
                                <div class="col-md-4 text-center">
                                    <h6 class="text-muted">Crescita</h6>
                                    <h4 id="revenue-growth">+0.0%</h4>
                                </div>
                            </div>

                            <div id="revenue-chart" class="mt-3">
                                <canvas id="revenueChartCanvas" width="400" height="200"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0"><i class="fas fa-trophy text-warning"></i> Top Spazi</h5>
                        </div>
                        <div class="card-body">
                            <div id="top-spaces-list">
                                <div class="text-center text-muted py-4">
                                    <i class="fas fa-building fa-2x mb-2"></i>
                                    <p>Caricamento top spazi...</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-4 mb-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="fas fa-credit-card fa-2x text-primary mb-2"></i>
                            <h6 class="text-muted">Pagamenti Medi</h6>
                            <h4 id="average-transaction">€0.00</h4>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-3">
                    <div class="card text-center">
                        <div class="card-body">
                            <i class="fas fa-clock fa-2x text-info mb-2"></i>
                            <h6 class="text-muted">Ultimo Aggiornamento</h6>
                            <small id="last-update">Ora</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="manager-section" id="spacesSection" style="display: none;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h4>
                    <i class="fas fa-building text-primary me-2"></i>
                    Gestione Spazi
                </h4>
                <button class="btn btn-manager-primary" onclick="showAddSpaceModal()">
                    <i class="fas fa-plus me-2"></i>Nuovo Spazio
                </button>
            </div>

            <div class="manager-card mb-4">
                <div class="row g-3">
                    <div class="col-md-3">
                        <label class="form-label">Cerca Spazio</label>
                        <input class="form-control" id="spaceSearch" placeholder="Nome, città, indirizzo..."
                               type="text">
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">Città</label>
                        <select class="form-select" id="cityFilter">
                            <option value="">Tutte le città</option>
                            <option value="Milano">Milano</option>
                            <option value="Roma">Roma</option>
                            <option value="Torino">Torino</option>
                            <option value="Bologna">Bologna</option>
                            <option value="Napoli">Napoli</option>
                        </select>
                    </div>
                    <div class="col-md-2">
                        <label class="form-label">Tipo</label>
                        <select class="form-select" id="spaceTypeFilter">
                            <option value="">Tutti i tipi</option>
                            <option value="hot-desk">Scrivania Condivisa</option>
                            <option value="private-office">Ufficio Privato</option>
                            <option value="meeting-room">Sala Meeting</option>
                            <option value="event-space">Spazio Eventi</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">&nbsp;</label>
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-primary" onclick="applyFilters()">
                                <i class="fas fa-search"></i> Filtra
                            </button>
                            <button class="btn btn-outline-secondary" onclick="resetSpaceFilters()">
                                <i class="fas fa-refresh"></i> Reset
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="manager-table">
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th>Spazio</th>
                        <th>Città</th>
                        <th>Tipo</th>
                        <th>Capienza</th>
                        <th>Prezzo/h</th>
                        <th>Azioni</th>
                    </tr>
                    </thead>
                    <tbody id="spacesTableBody">
                    <tr>
                        <td class="text-center py-4" colspan="8">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Caricamento...</span>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <div class="d-flex justify-content-between align-items-center mt-4">
                <div class="text-muted">
                    Mostra <span id="spacesShowing">0</span> di <span id="spacesTotal">0</span> spazi
                </div>
                <nav>
                    <ul class="pagination mb-0" id="spacesPagination">
                    </ul>
                </nav>
            </div>
        </div>

        <div class="modal fade" id="spaceModal" tabindex="-1">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-building me-2"></i>
                            <span id="spaceModalTitle">Nuovo Spazio</span>
                        </h5>
                        <button class="btn-close" data-bs-dismiss="modal" type="button"></button>
                    </div>
                    <div class="modal-body">
                        <form id="spaceForm">
                            <input id="spaceId" type="hidden">

                            <div class="row mb-4">
                                <div class="col-12">
                                    <h6 class="text-primary border-bottom pb-2 mb-3">
                                        <i class="fas fa-info-circle me-2"></i>Informazioni Base
                                    </h6>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Nome Spazio *</label>
                                    <input class="form-control" id="spaceName" required type="text">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Tipo Spazio *</label>
                                    <select class="form-select" id="spaceType" required>
                                        <option value="">Seleziona tipo</option>
                                        <option value="hot-desk">Scrivania Condivisa</option>
                                        <option value="private-office">Ufficio Privato</option>
                                        <option value="meeting-room">Sala Meeting</option>
                                        <option value="event-space">Spazio Eventi</option>
                                    </select>
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Capienza *</label>
                                    <input class="form-control" id="spaceCapacity" max="100" min="1" required
                                           type="number">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Prezzo/Ora (€) *</label>
                                    <input class="form-control" id="spacePrice" min="0" required step="0.50"
                                           type="number">
                                </div>
                            </div>

                            <div class="row mb-4">
                                <div class="col-12">
                                    <h6 class="text-primary border-bottom pb-2 mb-3">
                                        <i class="fas fa-map-marker-alt me-2"></i>Località
                                    </h6>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Città *</label>
                                    <select class="form-select" id="spaceCity" required>
                                        <option value="">Seleziona città</option>
                                        <option value="Milano">Milano</option>
                                        <option value="Roma">Roma</option>
                                        <option value="Torino">Torino</option>
                                        <option value="Bologna">Bologna</option>
                                        <option value="Napoli">Napoli</option>
                                        <option value="Firenze">Firenze</option>
                                        <option value="Genova">Genova</option>
                                        <option value="Palermo">Palermo</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Indirizzo *</label>
                                    <input class="form-control" id="spaceAddress" required type="text">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">CAP</label>
                                    <input class="form-control" id="spacePostalCode" pattern="[0-9]{5}" type="text">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Piano</label>
                                    <input class="form-control" id="spaceFloor" placeholder="es. 2°, PT, -1"
                                           type="text">
                                </div>
                                <div class="col-md-4">
                                    <label class="form-label">Numero Stanza</label>
                                    <input class="form-control" id="spaceRoom" placeholder="es. A1, 205, Open Space"
                                           type="text">
                                </div>
                            </div>

                            <div class="row mb-4">
                                <div class="col-12">
                                    <h6 class="text-primary border-bottom pb-2 mb-3">
                                        <i class="fas fa-concierge-bell me-2"></i>Servizi Inclusi
                                    </h6>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" id="wifiService" type="checkbox">
                                        <label class="form-check-label" for="wifiService">
                                            <i class="fas fa-wifi me-2"></i>WiFi Gratuito
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" id="coffeeService" type="checkbox">
                                        <label class="form-check-label" for="coffeeService">
                                            <i class="fas fa-coffee me-2"></i>Caffè/Tè
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" id="printerService" type="checkbox">
                                        <label class="form-check-label" for="printerService">
                                            <i class="fas fa-print me-2"></i>Stampante
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" id="projectorService" type="checkbox">
                                        <label class="form-check-label" for="projectorService">
                                            <i class="fas fa-video me-2"></i>Proiettore
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" id="whiteboardService" type="checkbox">
                                        <label class="form-check-label" for="whiteboardService">
                                            <i class="fas fa-chalkboard me-2"></i>Lavagna
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" id="parkingService" type="checkbox">
                                        <label class="form-check-label" for="parkingService">
                                            <i class="fas fa-parking me-2"></i>Parcheggio
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" id="airConditioningService" type="checkbox">
                                        <label class="form-check-label" for="airConditioningService">
                                            <i class="fas fa-snowflake me-2"></i>Aria Condizionata
                                        </label>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <div class="form-check">
                                        <input class="form-check-input" id="securityService" type="checkbox">
                                        <label class="form-check-label" for="securityService">
                                            <i class="fas fa-shield-alt me-2"></i>Sicurezza 24h
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="row mb-4">
                                <div class="col-12">
                                    <h6 class="text-primary border-bottom pb-2 mb-3">
                                        <i class="fas fa-align-left me-2"></i>Descrizione
                                    </h6>
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Descrizione Spazio *</label>
                                    <textarea class="form-control" id="spaceDescription" placeholder="Descrizione dettagliata dello spazio, atmosfera, particolarità..." rows="4" required></textarea>
                                </div>
                                <div class="col-12 mt-3">
                                    <label class="form-label">Note per Gestione</label>
                                    <textarea class="form-control" id="spaceNotes" placeholder="Note interne per la gestione dello spazio (non visibili ai clienti)" rows="2"></textarea>
                                </div>
                            </div>

                            <div class="row mb-4">
                                <div class="col-12">
                                    <h6 class="text-primary border-bottom pb-2 mb-3">
                                        <i class="fas fa-images me-2"></i>Immagini Spazio
                                    </h6>
                                </div>
                                <div class="col-12">
                                    <label class="form-label">Carica Immagini dello Spazio</label>
                                    <div class="mb-3">
                                        <input class="form-control" type="file" id="spaceImages" accept="image/jpeg,image/jpg,image/png,image/gif" multiple>
                                        <div class="form-text">
                                            <i class="fas fa-info-circle me-1"></i> Seleziona una o più immagini (JPG, PNG, GIF). Dimensione massima per file: 5MB.
                                        </div>
                                    </div>
                                    <div id="imagePreviewContainer" class="d-none">
                                        <label class="form-label text-muted mb-2">
                                            <i class="fas fa-eye me-1"></i>Anteprima immagini selezionate:
                                        </label>
                                        <div id="imagePreviewGrid" class="row g-3">
                                        </div>
                                    </div>
                                    <div id="imageDropZone" class="border border-2 border-dashed border-secondary rounded p-4 text-center text-muted mt-3" style="cursor: pointer;">
                                        <i class="fas fa-cloud-upload-alt fa-2x mb-2"></i>
                                        <p class="mb-1">Trascina le immagini qui o clicca per selezionarle</p>
                                        <small>Formato supportati: JPG, PNG, GIF</small>
                                    </div>
                                </div>
                            </div>

                            <div class="row">
                                <div class="col-12">
                                    <h6 class="text-primary border-bottom pb-2 mb-3">
                                        <i class="fas fa-clock me-2"></i>Orari di Disponibilità
                                    </h6>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Orario Apertura</label>
                                    <input class="form-control" id="spaceOpenTime" type="time" value="08:00">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Orario Chiusura</label>
                                    <input class="form-control" id="spaceCloseTime" type="time" value="20:00">
                                </div>
                                <div class="col-12 mt-3">
                                    <label class="form-label">Giorni Disponibili</label>
                                    <div class="d-flex gap-3 flex-wrap">
                                        <div class="form-check">
                                            <input checked class="form-check-input" id="dayMonday" type="checkbox">
                                            <label class="form-check-label" for="dayMonday">Lunedì</label>
                                        </div>
                                        <div class="form-check">
                                            <input checked class="form-check-input" id="dayTuesday" type="checkbox">
                                            <label class="form-check-label" for="dayTuesday">Martedì</label>
                                        </div>
                                        <div class="form-check">
                                            <input checked class="form-check-input" id="dayWednesday" type="checkbox">
                                            <label class="form-check-label" for="dayWednesday">Mercoledì</label>
                                        </div>
                                        <div class="form-check">
                                            <input checked class="form-check-input" id="dayThursday" type="checkbox">
                                            <label class="form-check-label" for="dayThursday">Giovedì</label>
                                        </div>
                                        <div class="form-check">
                                            <input checked class="form-check-input" id="dayFriday" type="checkbox">
                                            <label class="form-check-label" for="dayFriday">Venerdì</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" id="daySaturday" type="checkbox">
                                            <label class="form-check-label" for="daySaturday">Sabato</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" id="daySunday" type="checkbox">
                                            <label class="form-check-label" for="daySunday">Domenica</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Annulla</button>
                        <button class="btn btn-manager-primary" onclick="saveSpace()" type="button">
                            <i class="fas fa-save me-2"></i>Salva Spazio
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="spaceDetailsModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-eye me-2"></i>Dettagli Spazio
                        </h5>
                        <button class="btn-close" data-bs-dismiss="modal" type="button"></button>
                    </div>
                    <div class="modal-body" id="spaceDetailsContent">
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" data-bs-dismiss="modal" type="button">Chiudi</button>
                        <button class="btn btn-primary" onclick="editSpaceFromDetails()" type="button">
                            <i class="fas fa-edit me-2"></i>Modifica
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="manager-section" id="bookingsSection" style="display: none;">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h4>
                    <i class="fas fa-calendar-check text-primary me-2"></i>
                    Gestione Prenotazioni
                </h4>
                <button class="btn btn-manager-primary" onclick="showAddBookingModal()">
                    <i class="fas fa-plus me-2"></i>Nuova Prenotazione
                </button>
            </div>

            <div class="manager-card mb-4">
                <div class="row g-3">
                    <div class="col-md-3">
                        <label class="form-label">Cerca</label>
                        <input class="form-control" id="bookingSearch" placeholder="Nome cliente, spazio..."
                               type="text">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Stato</label>
                        <select class="form-select" id="bookingStatusFilter">
                            <option value="">Tutti</option>
                            <option value="confermata">Confermata</option>
                            <option value="in-attesa">In Attesa</option>
                            <option value="cancellata">Cancellata</option>
                            <option value="completata">Completata</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">Data</label>
                        <input class="form-control" id="bookingDateFilter" type="date">
                    </div>
                    <div class="col-md-3">
                        <label class="form-label">&nbsp;</label>
                        <div class="d-flex gap-2">
                            <button class="btn btn-outline-primary" onclick="applyBookingFilters()">
                                <i class="fas fa-search"></i> Filtra
                            </button>
                            <button class="btn btn-outline-secondary" onclick="resetBookingFilters()">
                                <i class="fas fa-refresh"></i> Reset
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="manager-table">
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th>ID</th>
                        <th>Cliente</th>
                        <th>Spazio</th>
                        <th>Data</th>
                        <th>Orario</th>
                        <th>Stato</th>
                        <th>Azioni</th>
                    </tr>
                    </thead>
                    <tbody id="bookingsTableBody">
                    <tr>
                        <td class="text-center py-4" colspan="7">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>

            <div class="d-flex justify-content-between align-items-center mt-4">
                <div class="text-muted">
                    Mostra <span id="bookingsShowing">0</span> di <span id="bookingsTotal">0</span> prenotazioni
                </div>
                <nav>
                    <ul class="pagination mb-0" id="bookingsPagination">
                    </ul>
                </nav>
            </div>
        </div>

        <div class="modal fade" id="bookingModal" tabindex="-1">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-calendar-plus me-2"></i>
                            <span id="bookingModalTitle">Nuova Prenotazione</span>
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="bookingForm">
                            <input type="hidden" id="bookingId">

                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label">ID Spazio *</label>
                                    <input type="text" class="form-control" id="spaceId" required>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">ID Utente *</label>
                                    <input type="text" class="form-control" id="userId" required>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label">Data *</label>
                                    <input type="date" class="form-control" id="bookingDate" required>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Orario Inizio *</label>
                                    <input type="time" class="form-control" id="startTime" required>
                                </div>
                            </div>
                            <div class="row mb-3">
                                <div class="col-md-6">
                                    <label class="form-label">Orario Fine *</label>
                                    <input type="time" class="form-control" id="endTime" required>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label">Stato *</label>
                                    <select class="form-select" id="bookingStatus" required>
                                        <option value="confermata">Confermata</option>
                                        <option value="in-attesa">In Attesa</option>
                                        <option value="cancellata">Cancellata</option>
                                        <option value="completata">Completata</option>
                                    </select>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Note</label>
                                <textarea class="form-control" id="bookingNotes" rows="2"></textarea>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                        <button type="button" class="btn btn-primary" onclick="saveBooking()">
                            <i class="fas fa-save me-2"></i>Salva Prenotazione
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="modal fade" id="deleteBookingModal" tabindex="-1">
            <div class="modal-dialog modal-sm">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Conferma Eliminazione</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        Sei sicuro di voler eliminare questa prenotazione?
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Annulla</button>
                        <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Elimina</button>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>
    // ==================== SECTIONS MANAGEMENT ====================
    // Funzione per mostrare la sezione corretta
    function showSection(sectionId) {
        // Nascondi tutte le sezioni
        document.querySelectorAll('.manager-section').forEach(section => {
            section.style.display = 'none';
        });

        // Mostra la sezione desiderata
        document.getElementById(sectionId + 'Section').style.display = 'block';

        // Aggiorna il titolo della pagina
        const pageTitle = document.getElementById('pageTitle');
        const sectionName = sectionId.charAt(0).toUpperCase() + sectionId.slice(1);
        pageTitle.textContent = sectionName;

        // Aggiorna lo stato attivo nella sidebar
        document.querySelectorAll('.sidebar-link').forEach(link => {
            link.classList.remove('active');
        });
        document.querySelector(`.sidebar-link[href="#${sectionId}"]`).classList.add('active');

        // Carica i dati per la sezione attiva
        if (sectionId === 'dashboard') {
            loadDashboardStats();
        } else if (sectionId === 'spaces') {
            loadSpaces();
        } else if (sectionId === 'bookings') {
            loadBookings();
        }
    }

    // ==================== DASHBOARD STATS ====================
    let dashboardStats = {
        totalUsers: 150,
        newUsers: 12,
        totalSpaces: 25,
        totalBookings: 89,
        confirmedBookings: 75,
        totalRevenue: 15800,
        totalPayments: 80,
        revenueData: [500, 600, 800, 750, 900, 1100],
        topSpaces: [
            { name: "Sala Riunioni A", bookings: 35 },
            { name: "Ufficio Privato 2", bookings: 28 },
            { name: "Scrivania Condivisa", bookings: 22 }
        ]
    };

    let revenueChart;

    function loadDashboardStats() {
        // Mostra il loading overlay
        const loadingOverlay = document.getElementById('dashboard-loading');
        loadingOverlay.style.display = 'block';

        setTimeout(() => {
            // Aggiorna le statistiche
            document.getElementById('total-users').textContent = dashboardStats.totalUsers;
            document.getElementById('new-users').textContent = dashboardStats.newUsers;
            document.getElementById('total-spaces').textContent = dashboardStats.totalSpaces;
            document.getElementById('total-bookings').textContent = dashboardStats.totalBookings;
            document.getElementById('confirmed-bookings').textContent = dashboardStats.confirmedBookings;
            document.getElementById('total-revenue').textContent = '€' + dashboardStats.totalRevenue.toFixed(2);
            document.getElementById('total-payments').textContent = dashboardStats.totalPayments;
            document.getElementById('current-revenue').textContent = '€' + dashboardStats.revenueData.slice(-1)[0].toFixed(2);
            document.getElementById('previous-revenue').textContent = '€' + dashboardStats.revenueData.slice(-2)[0].toFixed(2);
            const growth = ((dashboardStats.revenueData.slice(-1)[0] - dashboardStats.revenueData.slice(-2)[0]) / dashboardStats.revenueData.slice(-2)[0] * 100).toFixed(1);
            document.getElementById('revenue-growth').textContent = (growth > 0 ? '+' : '') + growth + '%';

            // Top spazi
            const topSpacesList = document.getElementById('top-spaces-list');
            topSpacesList.innerHTML = dashboardStats.topSpaces.map(space => `
                <div class="d-flex justify-content-between align-items-center mb-2">
                    <span class="text-truncate"><i class="fas fa-star text-warning me-2"></i>${space.name}</span>
                    <span class="badge bg-primary rounded-pill">${space.bookings}</span>
                </div>
            `).join('');

            // Grafico
            if (revenueChart) {
                revenueChart.destroy();
            }
            const ctx = document.getElementById('revenueChartCanvas').getContext('2d');
            revenueChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Gen', 'Feb', 'Mar', 'Apr', 'Mag', 'Giu'],
                    datasets: [{
                        label: 'Revenue (€)',
                        data: dashboardStats.revenueData,
                        backgroundColor: 'rgba(40, 167, 69, 0.2)',
                        borderColor: '#28a745',
                        borderWidth: 2,
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });

            // Nascondi il loading overlay
            loadingOverlay.style.display = 'none';

        }, 1000); // Simulazione ritardo di rete
    }

    // ==================== SPACES MANAGEMENT ====================
    let currentSpacePage = 1;
    let spacesData = [
        { id: 1, name: 'Sala Riunioni Grande', city: 'Milano', type: 'meeting-room', capacity: 20, price: 50, services: ['wifi', 'projector', 'whiteboard'], imageUrl: 'path/to/image1.jpg' },
        { id: 2, name: 'Ufficio Privato 1', city: 'Roma', type: 'private-office', capacity: 4, price: 30, services: ['wifi', 'coffee'], imageUrl: 'path/to/image2.jpg' },
        { id: 3, name: 'Scrivania Condivisa', city: 'Milano', type: 'hot-desk', capacity: 1, price: 10, services: ['wifi', 'coffee'], imageUrl: 'path/to/image3.jpg' },
        { id: 4, name: 'Sala Eventi', city: 'Roma', type: 'event-space', capacity: 50, price: 100, services: ['wifi', 'projector', 'parking'], imageUrl: 'path/to/image4.jpg' },
        { id: 5, name: 'Sala Riunioni Piccola', city: 'Milano', type: 'meeting-room', capacity: 8, price: 25, services: ['wifi', 'whiteboard'], imageUrl: 'path/to/image5.jpg' }
    ];

    function loadSpaces(page = 1, filters = {}) {
        const tableBody = document.getElementById('spacesTableBody');
        const showCount = document.getElementById('spacesShowing');
        const totalCount = document.getElementById('spacesTotal');
        const pagination = document.getElementById('spacesPagination');

        tableBody.innerHTML = `<tr><td class="text-center py-4" colspan="6"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Caricamento...</span></div></td></tr>`;

        setTimeout(() => {
            let filteredSpaces = spacesData.filter(space => {
                const searchMatch = !filters.search || space.name.toLowerCase().includes(filters.search.toLowerCase()) || space.city.toLowerCase().includes(filters.search.toLowerCase());
                const cityMatch = !filters.city || space.city === filters.city;
                const typeMatch = !filters.type || space.type === filters.type;
                return searchMatch && cityMatch && typeMatch;
            });

            const itemsPerPage = 10;
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedSpaces = filteredSpaces.slice(startIndex, endIndex);

            tableBody.innerHTML = '';
            if (paginatedSpaces.length === 0) {
                tableBody.innerHTML = `<tr><td class="text-center py-4 text-muted" colspan="6">Nessuno spazio trovato.</td></tr>`;
            } else {
                paginatedSpaces.forEach(space => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${space.name}</td>
                        <td>${space.city}</td>
                        <td>${space.type}</td>
                        <td>${space.capacity}</td>
                        <td>€${space.price}/h</td>
                        <td>
                            <button class="btn btn-sm btn-outline-info me-2" onclick="showSpaceDetailsModal(${space.id})"><i class="fas fa-eye"></i></button>
                            <button class="btn btn-sm btn-outline-primary me-2" onclick="editSpace(${space.id})"><i class="fas fa-edit"></i></button>
                            <button class="btn btn-sm btn-outline-danger" onclick="deleteSpace(${space.id})"><i class="fas fa-trash"></i></button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            }

            showCount.textContent = paginatedSpaces.length;
            totalCount.textContent = filteredSpaces.length;

            renderPagination(filteredSpaces.length, itemsPerPage, page);
        }, 500);
    }

    function renderPagination(totalItems, itemsPerPage, currentPage) {
        const pagination = document.getElementById('spacesPagination');
        pagination.innerHTML = '';
        const totalPages = Math.ceil(totalItems / itemsPerPage);

        for (let i = 1; i <= totalPages; i++) {
            const li = document.createElement('li');
            li.className = `page-item ${i === currentPage ? 'active' : ''}`;
            li.innerHTML = `<a class="page-link" href="#" onclick="loadSpaces(${i}, getSpaceFilters())">${i}</a>`;
            pagination.appendChild(li);
        }
    }

    function getSpaceFilters() {
        return {
            search: document.getElementById('spaceSearch').value,
            city: document.getElementById('cityFilter').value,
            type: document.getElementById('spaceTypeFilter').value
        };
    }

    function applyFilters() {
        loadSpaces(1, getSpaceFilters());
    }

    function resetSpaceFilters() {
        document.getElementById('spaceSearch').value = '';
        document.getElementById('cityFilter').value = '';
        document.getElementById('spaceTypeFilter').value = '';
        loadSpaces();
    }

    function showAddSpaceModal() {
        document.getElementById('spaceModalTitle').textContent = 'Nuovo Spazio';
        document.getElementById('spaceId').value = '';
        document.getElementById('spaceForm').reset();
        const spaceModal = new bootstrap.Modal(document.getElementById('spaceModal'));
        spaceModal.show();
    }

    function saveSpace() {
        const spaceId = document.getElementById('spaceId').value;
        const newSpace = {
            id: spaceId || spacesData.length + 1,
            name: document.getElementById('spaceName').value,
            city: document.getElementById('spaceCity').value,
            type: document.getElementById('spaceType').value,
            capacity: parseInt(document.getElementById('spaceCapacity').value),
            price: parseFloat(document.getElementById('spacePrice').value),
            services: [],
            imageUrl: ''
        };

        if (spaceId) {
            const index = spacesData.findIndex(s => s.id == spaceId);
            if (index > -1) {
                spacesData[index] = newSpace;
            }
        } else {
            spacesData.push(newSpace);
        }

        loadSpaces();
        const modal = bootstrap.Modal.getInstance(document.getElementById('spaceModal'));
        modal.hide();
    }

    function editSpace(id) {
        const space = spacesData.find(s => s.id === id);
        if (space) {
            document.getElementById('spaceModalTitle').textContent = 'Modifica Spazio';
            document.getElementById('spaceId').value = space.id;
            document.getElementById('spaceName').value = space.name;
            document.getElementById('spaceType').value = space.type;
            document.getElementById('spaceCapacity').value = space.capacity;
            document.getElementById('spacePrice').value = space.price;
            document.getElementById('spaceCity').value = space.city;
            document.getElementById('spaceAddress').value = space.address || '';
            document.getElementById('spacePostalCode').value = space.postalCode || '';
            document.getElementById('spaceFloor').value = space.floor || '';
            document.getElementById('spaceRoom').value = space.room || '';
            document.getElementById('spaceDescription').value = space.description || '';
            document.getElementById('spaceNotes').value = space.notes || '';

            const spaceModal = new bootstrap.Modal(document.getElementById('spaceModal'));
            spaceModal.show();
        }
    }

    function showSpaceDetailsModal(id) {
        const space = spacesData.find(s => s.id === id);
        if (space) {
            const content = document.getElementById('spaceDetailsContent');
            content.innerHTML = `
                <div class="row">
                    <div class="col-md-6">
                        <h6>Nome:</h6>
                        <p>${space.name}</p>
                        <h6>Città:</h6>
                        <p>${space.city}</p>
                        <h6>Tipo:</h6>
                        <p>${space.type}</p>
                    </div>
                    <div class="col-md-6">
                        <h6>Capienza:</h6>
                        <p>${space.capacity}</p>
                        <h6>Prezzo/h:</h6>
                        <p>€${space.price}</p>
                        <h6>Indirizzo:</h6>
                        <p>${space.address || 'N/A'}</p>
                    </div>
                </div>
            `;
            const spaceDetailsModal = new bootstrap.Modal(document.getElementById('spaceDetailsModal'));
            spaceDetailsModal.show();
        }
    }

    function deleteSpace(id) {
        if (confirm('Sei sicuro di voler eliminare questo spazio?')) {
            spacesData = spacesData.filter(s => s.id !== id);
            loadSpaces();
            alert('Spazio eliminato con successo!');
        }
    }

    // ==================== BOOKINGS MANAGEMENT ====================
    let bookingsData = [
        { id: 1, userId: 101, spaceId: 1, spaceName: 'Sala Riunioni A', userName: 'Mario Rossi', date: '2025-08-25', startTime: '10:00', endTime: '12:00', status: 'confermata' },
        { id: 2, userId: 102, spaceId: 3, spaceName: 'Scrivania Condivisa', userName: 'Giulia Verdi', date: '2025-08-26', startTime: '14:00', endTime: '16:00', status: 'in-attesa' },
        { id: 3, userId: 101, spaceId: 2, spaceName: 'Ufficio Privato', userName: 'Mario Rossi', date: '2025-08-27', startTime: '09:00', endTime: '17:00', status: 'confermata' }
    ];

    function loadBookings(page = 1, filters = {}) {
        const tableBody = document.getElementById('bookingsTableBody');
        const showCount = document.getElementById('bookingsShowing');
        const totalCount = document.getElementById('bookingsTotal');
        const pagination = document.getElementById('bookingsPagination');

        tableBody.innerHTML = `<tr><td class="text-center py-4" colspan="7"><div class="spinner-border text-primary" role="status"><span class="visually-hidden">Caricamento...</span></div></td></tr>`;

        setTimeout(() => {
            let filteredBookings = bookingsData.filter(booking => {
                const searchMatch = !filters.search || booking.userName.toLowerCase().includes(filters.search.toLowerCase()) || booking.spaceName.toLowerCase().includes(filters.search.toLowerCase());
                const statusMatch = !filters.status || booking.status === filters.status;
                const dateMatch = !filters.date || booking.date === filters.date;
                return searchMatch && statusMatch && dateMatch;
            });

            const itemsPerPage = 10;
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedBookings = filteredBookings.slice(startIndex, endIndex);

            tableBody.innerHTML = '';
            if (paginatedBookings.length === 0) {
                tableBody.innerHTML = `<tr><td class="text-center py-4 text-muted" colspan="7">Nessuna prenotazione trovata.</td></tr>`;
            } else {
                paginatedBookings.forEach(booking => {
                    const row = document.createElement('tr');
                    let statusClass = '';
                    switch (booking.status) {
                        case 'confermata':
                            statusClass = 'status-active';
                            break;
                        case 'in-attesa':
                            statusClass = 'status-suspended';
                            break;
                        case 'cancellata':
                            statusClass = 'status-inactive';
                            break;
                        case 'completata':
                            statusClass = 'status-active';
                            break;
                    }

                    row.innerHTML = `
                        <td>${booking.id}</td>
                        <td>${booking.userName}</td>
                        <td>${booking.spaceName}</td>
                        <td>${booking.date}</td>
                        <td>${booking.startTime} - ${booking.endTime}</td>
                        <td><span class="status-badge ${statusClass}">${booking.status}</span></td>
                        <td>
                            <button class="btn btn-sm btn-outline-info me-2" onclick="showBookingDetailsModal(${booking.id})"><i class="fas fa-eye"></i></button>
                            <button class="btn btn-sm btn-outline-primary me-2" onclick="editBooking(${booking.id})"><i class="fas fa-edit"></i></button>
                            <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteBookingModal" data-booking-id="${booking.id}"><i class="fas fa-trash"></i></button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            }

            showCount.textContent = paginatedBookings.length;
            totalCount.textContent = filteredBookings.length;

            renderBookingPagination(filteredBookings.length, itemsPerPage, page);
        }, 500);
    }

    function renderBookingPagination(totalItems, itemsPerPage, currentPage) {
        const pagination = document.getElementById('bookingsPagination');
        pagination.innerHTML = '';
        const totalPages = Math.ceil(totalItems / itemsPerPage);

        for (let i = 1; i <= totalPages; i++) {
            const li = document.createElement('li');
            li.className = `page-item ${i === currentPage ? 'active' : ''}`;
            li.innerHTML = `<a class="page-link" href="#" onclick="loadBookings(${i}, getBookingFilters())">${i}</a>`;
            pagination.appendChild(li);
        }
    }

    function getBookingFilters() {
        return {
            search: document.getElementById('bookingSearch').value,
            status: document.getElementById('bookingStatusFilter').value,
            date: document.getElementById('bookingDateFilter').value
        };
    }

    function applyBookingFilters() {
        loadBookings(1, getBookingFilters());
    }

    function resetBookingFilters() {
        document.getElementById('bookingSearch').value = '';
        document.getElementById('bookingStatusFilter').value = '';
        document.getElementById('bookingDateFilter').value = '';
        loadBookings();
    }

    function showAddBookingModal() {
        document.getElementById('bookingModalTitle').textContent = 'Nuova Prenotazione';
        document.getElementById('bookingId').value = '';
        document.getElementById('bookingForm').reset();
        const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
        bookingModal.show();
    }

    function saveBooking() {
        const bookingId = document.getElementById('bookingId').value;
        const newBooking = {
            id: bookingId || bookingsData.length + 1,
            userId: document.getElementById('userId').value,
            spaceId: document.getElementById('spaceId').value,
            date: document.getElementById('bookingDate').value,
            startTime: document.getElementById('startTime').value,
            endTime: document.getElementById('endTime').value,
            status: document.getElementById('bookingStatus').value,
            notes: document.getElementById('bookingNotes').value
        };

        if (bookingId) {
            const index = bookingsData.findIndex(b => b.id == bookingId);
            if (index > -1) {
                bookingsData[index] = newBooking;
            }
        } else {
            bookingsData.push(newBooking);
        }

        loadBookings();
        const modal = bootstrap.Modal.getInstance(document.getElementById('bookingModal'));
        modal.hide();
    }

    function editBooking(id) {
        const booking = bookingsData.find(b => b.id === id);
        if (booking) {
            document.getElementById('bookingModalTitle').textContent = 'Modifica Prenotazione';
            document.getElementById('bookingId').value = booking.id;
            document.getElementById('userId').value = booking.userId;
            document.getElementById('spaceId').value = booking.spaceId;
            document.getElementById('bookingDate').value = booking.date;
            document.getElementById('startTime').value = booking.startTime;
            document.getElementById('endTime').value = booking.endTime;
            document.getElementById('bookingStatus').value = booking.status;
            document.getElementById('bookingNotes').value = booking.notes || '';
            const bookingModal = new bootstrap.Modal(document.getElementById('bookingModal'));
            bookingModal.show();
        }
    }

    function showBookingDetailsModal(id) {
        const booking = bookingsData.find(b => b.id === id);
        if (booking) {
            // Implement logic to show booking details in a modal
            alert(`Dettagli Prenotazione #${booking.id}: Cliente ${booking.userName}, Spazio ${booking.spaceName}, Data ${booking.date}`);
        }
    }

    function deleteBooking(id) {
        bookingsData = bookingsData.filter(b => b.id !== parseInt(id));
        loadBookings();
        alert('Prenotazione eliminata con successo!');
    }

    document.addEventListener('DOMContentLoaded', () => {
        // Avvia la prima sezione (Dashboard)
        showSection('dashboard');

        const confirmDeleteBtn = document.getElementById('confirmDeleteBtn');
        const deleteBookingModal = document.getElementById('deleteBookingModal');
        let bookingToDeleteId = null;

        deleteBookingModal.addEventListener('show.bs.modal', function (event) {
            const button = event.relatedTarget;
            bookingToDeleteId = button.getAttribute('data-booking-id');
        });

        confirmDeleteBtn.addEventListener('click', () => {
            if (bookingToDeleteId) {
                deleteBooking(bookingToDeleteId);
                const modal = bootstrap.Modal.getInstance(deleteBookingModal);
                modal.hide();
            }
        });
    });
</script>
</body>
</html>