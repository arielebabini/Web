<!DOCTYPE html>
<html lang="it" data-theme="auto">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CoWorkSpace - Gestione Spazi Condivisi</title>
    <meta name="description" content="Piattaforma per la gestione e prenotazione di spazi coworking, uffici condivisi e sale riunioni.">

    <!-- Preconnect for performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- CSS Framework and Custom Styles -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

    <!-- Custom CSS - PERCORSI CORRETTI (relativo alla posizione di index.html in Web/frontend/) -->
    <link href="./assets/css/variables.css" rel="stylesheet">
    <link href="./assets/css/layout.css" rel="stylesheet">
    <link href="./assets/css/components.css" rel="stylesheet">
    <link href="./assets/css/animations.css" rel="stylesheet">
    <link href="./assets/css/responsive.css" rel="stylesheet">

    <!-- Favicon and icons -->
    <link rel="icon" href="./assets/images/favicon.svg" type="image/svg+xml">

    <!-- Open Graph and Twitter Cards -->
    <meta property="og:title" content="CoWorkSpace - Gestione Spazi Condivisi">
    <meta property="og:description" content="Trova e prenota il tuo spazio di lavoro ideale">
    <meta property="og:image" content="./assets/images/og-image.jpg">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">

    <!-- Theme detection script -->
    <script>
        (function() {
            const theme = localStorage.getItem('coworkspace_theme') ||
                (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
            document.documentElement.setAttribute('data-theme', theme);
        })();
    </script>

    <!-- Initialize Configuration before other scripts -->
    <script>
        // Configurazione globale dell'applicazione
        window.CoWorkSpaceConfig = {
            app: {
                name: 'CoWorkSpace',
                version: '1.0.0',
                environment: 'development',
                debug: true
            },
            api: {
                baseURL: 'http://localhost:3000/api',
                timeout: 10000,
                retryAttempts: 3,
                retryDelay: 1000
            },
            auth: {
                tokenKey: 'coworkspace_token',
                refreshTokenKey: 'coworkspace_refresh_token',
                userKey: 'coworkspace_user',
                tokenExpiry: 3600000, // 1 hour
                refreshTokenExpiry: 604800000 // 7 days
            },
            ui: {
                animationDuration: 300,
                notificationDuration: 5000,
                modalBackdrop: true,
                loadingDelay: 200
            },
            features: {
                enableAnalytics: true,
                enableNotifications: true,
                enableCookieBanner: true,
                enableDarkMode: true,
                enablePWA: false
            },
            storage: {
                prefix: 'coworkspace_',
                type: 'localStorage' // or 'sessionStorage'
            },
            routes: {
                defaultSection: 'home',
                authRequired: ['dashboard', 'profile', 'bookings'],
                adminRequired: ['dashboard']
            }
        };
    </script>
</head>

<body>
<!-- ‚úÖ Navigation Component Container -->
<div id="navbar-container"></div>

<!-- ‚úÖ Main Content Container -->
<main id="main-content" class="main-content">
    <!-- ‚úÖ Dynamic content sections will be loaded here -->
    <div id="content-container" class="container mt-4">
        <!-- Contenuto iniziale di caricamento -->
        <div class="text-center py-5">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Caricamento...</span>
            </div>
            <p class="mt-3">Caricamento applicazione...</p>
        </div>
    </div>
</main>

<!-- ‚úÖ Footer Component Container -->
<div id="footer-container"></div>

<!-- ‚úÖ Modal Container -->
<div id="modal-container"></div>

<!-- ‚úÖ Cookie Banner Container -->
<div id="cookie-banner-container"></div>

<!-- ‚úÖ Back to Top Button -->
<button id="back-to-top" class="back-to-top d-none" aria-label="Torna in alto">
    <i class="fas fa-chevron-up"></i>
</button>

<!-- ‚úÖ Loading Overlay Container -->
<div id="loading-overlay-container"></div>

<!-- ‚úÖ Notification Container -->
<div id="notification-container" class="notification-container"></div>

<!-- External JavaScript Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>

<!-- Custom JavaScript Modules (in order of dependency) - PERCORSI CORRETTI -->
<script src="./assets/js/config.js"></script>
<script src="./assets/js/utils.js"></script>
<script src="./assets/js/api.js"></script>
<script src="./assets/js/auth.js"></script>
<script src="./assets/js/navigation.js"></script>
<script src="./assets/js/spaces.js"></script>
<script src="./assets/js/booking.js"></script>
<script src="./assets/js/dashboard.js"></script>
<script src="./assets/js/user.js"></script>
<script src="./assets/js/components.js"></script>
<script src="./assets/js/app.js"></script>

<!-- App Initialization -->
<script>
    // Initialize app when DOM is ready
    document.addEventListener('DOMContentLoaded', function() {
        // Verifica che tutti i moduli siano caricati
        console.log('üîç Checking modules...');
        const modules = [
            'CoWorkSpaceConfig',
            'Utils',
            'API',
            'Auth',
            'Navigation',
            'Spaces',
            'Bookings',
            'Dashboard',
            'User',
            'Components',
            'App'
        ];

        let allModulesLoaded = true;
        modules.forEach(module => {
            if (typeof window[module] === 'undefined') {
                console.warn(`‚ö†Ô∏è Module ${module} not loaded`);
                allModulesLoaded = false;
            } else {
                console.log(`‚úÖ Module ${module} loaded`);
            }
        });

        // Se App √® disponibile, prova ad inizializzare
        if (window.App) {
            App.init().then(() => {
                console.log('‚úÖ CoWorkSpace App initialized successfully!');
            }).catch(error => {
                console.error('‚ùå App initialization failed:', error);
                showErrorMessage(error);
            });
        } else if (!allModulesLoaded) {
            console.error('‚ùå Critical modules not loaded');
            showErrorMessage('Moduli critici non caricati');
        }

        function showErrorMessage(error) {
            document.getElementById('content-container').innerHTML = `
                    <div class="alert alert-danger" role="alert">
                        <h4 class="alert-heading">Errore di inizializzazione</h4>
                        <p>Si √® verificato un errore durante il caricamento dell'applicazione.</p>
                        <hr>
                        <p class="mb-0">Dettaglio errore: ${error}</p>
                        <p class="mt-3">
                            <button class="btn btn-danger" onclick="location.reload()">
                                <i class="fas fa-redo"></i> Ricarica la pagina
                            </button>
                        </p>
                    </div>
                `;
        }
    });
</script>
</body>
</html>